{"version":3,"names":["_sfc_main","components","data","search","keywords","params","isFetch","history","hot","onPullDownRefresh","onShareAppMessage","mounted","getHistoryData","fetchHotSearch","methods","that","categoryList","taxonomy","then","res","status","forEach","item","push","name","onSearch","setHistoryData","onCancel","common_vendor","index","getStorageSync","length","slice","indexOf","splice","setStorageSync","clearHistoryData","showModal","title","content","success","confirm","removeStorageSync","onClickKeywords","wx","createPage","MiniProgramPage"],"sources":["search.vue","D:/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvc2VhcmNoL3NlYXJjaC52dWU"],"sourcesContent":["<template>\r\n    <view class=\"sticky-top\">\r\n        <view class=\"search\">\r\n            <uni-search-bar\r\n                v-model=\"keywords\"\r\n                :focus=\"true\"\r\n                placeholder=\"搜索关键词...\"\r\n                radius=\"100\"\r\n                maxlength=\"100\"\r\n                @confirm=\"onSearch\"\r\n                @cancel=\"onCancel\"\r\n                @clear=\"onCancel\"\r\n            />\r\n        </view>\r\n    </view>\r\n\r\n    <view v-if=\"search == false\">\r\n        <uni-section v-if=\"history.length > 0\" title=\"历史搜索\" titleFontSize=\"15px\" type=\"square\">\r\n            <template v-slot:right>\r\n                <uni-icons @click=\"clearHistoryData\" type=\"trash\" size=\"22\"></uni-icons>\r\n            </template>\r\n            \r\n            <view class=\"search-content\">\r\n                <template v-for=\"(item, index) in history\" :key=\"index\">\r\n                    <text @click=\"onClickKeywords(item)\" class=\"title\">{{ item }}</text>\r\n                </template>\r\n            </view>\r\n        </uni-section>\r\n\r\n        <uni-section title=\"热门搜索\" titleFontSize=\"15px\" type=\"square\">\r\n            <view class=\"search-content\">\r\n                <template v-for=\"(item, index) in hot\" :key=\"index\">\r\n                    <text @click=\"onClickKeywords(item)\" class=\"title\">{{ item }}</text>\r\n                </template>\r\n            </view>\r\n        </uni-section>\r\n    </view>\r\n</template>\r\n\r\n<script>\r\n    import { mapActions } from 'pinia'\r\n    export default {\r\n        components: {\r\n        },\r\n        data() {\r\n            return {\r\n                search: false, // 0 搜索面板 1 结果面板\r\n                keywords: '',\r\n                params: { keywords: '' },\r\n                isFetch: false,\r\n                history: [],\r\n                hot: []\r\n            }\r\n        },\r\n        onPullDownRefresh() {\r\n\r\n        },\r\n        onShareAppMessage() {},\r\n        mounted() {\r\n            // 获取搜索历史\r\n            this.getHistoryData()\r\n            this.fetchHotSearch()\r\n        },\r\n        methods: {\r\n            fetchHotSearch() {\r\n                var that = this\r\n                this.categoryList({taxonomy: 'search'}).then(res => {\r\n                    if (res.status == true) {\r\n                        var hot = []\r\n                        res.data.forEach(item => {\r\n                            hot.push(item.name)\r\n                        })\r\n                        that.hot = hot\r\n                    }\r\n                })\r\n            },\r\n            onSearch() {\r\n                this.search = true\r\n                this.isFetch = true\r\n                // 设置搜索历史\r\n                this.params.keywords = this.keywords\r\n                this.setHistoryData(this.keywords)\r\n            },\r\n            onCancel() {\r\n                this.search = false\r\n                this.isFetch = false\r\n            },\r\n            getHistoryData() {\r\n                var history = uni.getStorageSync('searchHistoryKeywords')\r\n                // 位置有限，后20个\r\n                if (history.length > 20) {\r\n                    this.history = history.slice(-20)\r\n                } else {\r\n                    this.history = history ? history : []\r\n                }\r\n            },\r\n            setHistoryData(keywords) {\r\n                var data = this.history\r\n\r\n                // 是否在数组中 删除\r\n                var index = data.indexOf(keywords)\r\n                if (index > -1) {\r\n                    data.splice(index, 1)\r\n                }\r\n                data.push(keywords)\r\n                uni.setStorageSync('searchHistoryKeywords', data)\r\n            },\r\n            clearHistoryData() {\r\n                var that = this\r\n                uni.showModal({\r\n                    title: '确认提示',\r\n                    content: '确定要删除搜索记录?',\r\n                    success: function (res) {\r\n                        if (res.confirm) {\r\n                            uni.removeStorageSync('searchHistoryKeywords')\r\n                            that.history = []\r\n                        }\r\n                    }\r\n                });\r\n            },\r\n            onClickKeywords(keywords) {\r\n                this.keywords = keywords\r\n                this.onSearch()\r\n            }\r\n        }\r\n    }\r\n</script>\r\n\r\n<style>\r\n.search {\r\n    width: 100%;\r\n    background:white;\r\n    border-bottom: 1px solid #f2f2f2;\r\n}\r\n.search-content {\r\n    padding: 0 10px 10px 10px;\r\n    display: flex;\r\n    flex-wrap: wrap;\r\n}\r\n.title {\r\n    padding: 3px 15px;\r\n    margin: 3px 5px;\r\n    background-color: #f2f2f2;\r\n    border-radius: 20px;\r\n    color:#3b4144;\r\n    font-size: 14px;\r\n}\r\n</style>","import MiniProgramPage from 'E:/工具APP/uniapp-tool/pages/search/search.vue'\nwx.createPage(MiniProgramPage)"],"mappings":"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","ignoreList":[]}